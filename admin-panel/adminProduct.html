<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.css">
</head>
<body style="margin:0; padding:0; background:#f3f4f6;">
    <div style="display:flex; min-height:100vh;">
    <nav id="sidebar" class="sidebar" style="width: 256px; background-color: #1f2937; color: white; flex-direction: column;">
            <div class="sidebar-header" style="padding: 24px; border-bottom: 1px solid #374151; text-align: center;">
                <a href="/admin-panel/dashboard.html" style="color: white; text-decoration: none;">
                    <h2 style="font-size: 24px; font-weight: bold; margin:0;">Admin Panel</h2>
                </a>
            </div>
            <ul class="sidebar-nav" style="flex: 1; padding: 16px; list-style: none;">
                <li style="margin-bottom: 8px;">
                    <a href="adminBlog.html" class="nav-link" onclick="showDashboardPage('add-blog')" style="display: flex; align-items: center; padding: 12px; color: white; text-decoration: none; border-radius: 8px; transition: background-color 0.2s; font-size: 16px;">
                        <span style="margin-right: 12px; font-size: 18px;">üìù</span> Add Blog
                    </a>
                </li>
                <li style="margin-bottom: 8px;">
                    <a href="adminProduct.html" class="nav-link" onclick="showDashboardPage('add-product')" style="display: flex; align-items: center; padding: 12px; color: white; text-decoration: none; border-radius: 8px; transition: background-color 0.2s; font-size: 16px;">
                        <span style="margin-right: 12px; font-size: 18px;">üì¶</span> Add Product
                    </a>
                </li>
                <li style="margin-bottom: 8px;">
                    <a href="adminContact.html" class="nav-link" onclick="showDashboardPage('contact-form')" style="display: flex; align-items: center; padding: 12px; color: white; text-decoration: none; border-radius: 8px; transition: background-color 0.2s; font-size: 16px;">
                        <span style="margin-right: 12px; font-size: 18px;">üìß</span> Contact Form
                    </a>
                </li>
            </ul>
            <div class="sidebar-footer" style="padding: 16px; border-top: 1px solid #374151;">
                <button class="logout-btn" style="width: 100%; display: flex; align-items: center; justify-content: center; padding: 12px; background-color: #dc2626; color: white; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.2s; font-size: 16px;" onclick="logout()">
                    <span style="margin-right: 12px; font-size: 18px;">üö™</span> Logout
                </button>
            </div>
        </nav>
        <div class="add-product-container" style="flex:1; display: flex; justify-content: center; align-items: center; min-height: 100vh;">
            <form class="add-product-form" style="background: #fff; padding: 32px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 100%; max-width: 500px;">
                <h2 style="text-align: center; margin-bottom: 24px; font-size: 24px; font-weight: bold; color: #1f2937;">Add Product</h2>
                <div class="form-group" style="margin-bottom: 16px;">
                    <label for="product-title" style="display: block; margin-bottom: 4px; font-weight: 500; color: #374151;">Title</label>
                    <input type="text" id="product-title" name="title" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 16px;">
                </div>
                <div class="form-group" style="margin-bottom: 16px;">
                    <label for="product-content" style="display: block; margin-bottom: 4px; font-weight: 500; color: #374151;">Content</label>
                    <textarea id="product-content" name="content" rows="5" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 16px; resize: vertical;"></textarea>
                </div>
                <div class="form-group" style="margin-bottom: 24px;">
                    <label for="product-image" style="display: block; margin-bottom: 4px; font-weight: 500; color: #374151;">Image</label>
                    <input type="file" id="product-image" name="image" accept="image/*" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 16px;">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px; border: none; border-radius: 4px; font-size: 16px; font-weight: 600; background-color: #2563eb; color: white; cursor: pointer;">Add Product</button>
            </form>
        </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.js"></script>
    <script>
    function logout() {
        window.location.href = 'login.html';
    }
    async function handleAddProduct(event) {
        event.preventDefault();
        console.log('Form submitted'); // Debug log
        const title = document.getElementById('product-title').value;
        const content = document.getElementById('product-content').value;
        const imageInput = document.getElementById('product-image');
        const imageFile = imageInput.files[0];
        console.log('Form data:', { title, content, imageFile }); // Debug log
        if (!imageFile) {
            console.log('No image selected'); // Debug log
            Toastify({
                text: 'Please select an image.',
                duration: 3000,
                gravity: "top",
                position: "center",
                backgroundColor: "#ef4444",
                close: true
            }).showToast();
            return;
        }
        const formData = new FormData();
        formData.append('title', title);
        formData.append('content', content);
        formData.append('image', imageFile);
        try {
            console.log('Sending request to server...'); // Debug log
            const response = await fetch('http://localhost:5000/product', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();
            console.log('Server response:', data); // Debug log
            if (response.ok) {
                console.log('Success! Showing popup...'); // Debug log
                Toastify({
                    text: data.message || 'Product added successfully!',
                    duration: 3000,
                    gravity: "top",
                    position: "center",
                    backgroundColor: "#10b981",
                    close: true
                }).showToast();
                event.target.reset();
            } else {
                console.log('Error response:', data); // Debug log
                Toastify({
                    text: data.error || 'Failed to add product.',
                    duration: 3000,
                    gravity: "top",
                    position: "center",
                    backgroundColor: "#ef4444",
                    close: true
                }).showToast();
            }
        } catch (err) {
            console.error('Network error:', err); // Debug log
            Toastify({
                text: 'Network error. Please try again.',
                duration: 3000,
                gravity: "top",
                position: "center",
                backgroundColor: "#ef4444",
                close: true
            }).showToast();
        }
    }
        // Attach event handler to form after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.add-product-form').addEventListener('submit', handleAddProduct);
        });
    </script>
</body>
</html>